SELECT *
FROM ErrorAP WITH (NOLOCK)
WHERE TranID IN (139110849595,139111488091,139111560863,139145490225)

DROP TABLE IF EXISTS #TempJobs
SELECT DISTINCT acctID
INTO #TempJobs
FROM ErrorAP WITH (NOLOCK)
WHERE TranID IN (139110849595,139111488091,139111560863,139145490225)

SELECT T.acctID, COUNT(1)
FROM CPSgmentAccounts CP WITH (NOLOCK)
JOIN #TempJobs T ON (CP.parent02AID = -T.acctID)
GROUP BY T.acctID

--847405		68
--2437629		95
--2757430		57
--11409681		79

SELECT SH.parent02AID, SH.StatementDate, COUNT(1) RecordCount
FROM SummaryHeader SH WITH (NOLOCK)
JOIN #TempJobs C ON (SH.parent02AID = C.acctID)
WHERE StatementDate BETWEEN '2023-08-31 23:59:57' AND '2025-04-30 23:59:57'
GROUP BY SH.parent02AID, SH.StatementDate
ORDER BY SH.parent02AID, SH.StatementDate DESC

SELECT SH.parent02AID, SH.StatementDate, COUNT(1) RecordCount
FROM SummaryHeader SH WITH (NOLOCK)
WHERE StatementDate BETWEEN '2023-08-31 23:59:57' AND '2025-04-30 23:59:57'
AND SH.parent02AID = 847405
GROUP BY SH.parent02AID, SH.StatementDate
ORDER BY SH.parent02AID, SH.StatementDate DESC

SELECT COUNT(1)
FROM SummaryHeader Sh WITH (NOLOCK)
WHERE StatementDate = '2023-07-31 23:59:57'
AND parent02AID = -847405