-- 6a1746f4-8998-4a5e-9ba8-c4b8e3ace50f

SELECT * 
FROM LS_PRODDRGSDB01.ccgs_coreissue.dbo.CurrentBalanceAudit WITH (NOLOCK)
WHERE AID IN (6730375)
--AND DENAME IN (112)
AND Businessday >= '2022-06-30 23:59:57.000'
--AND TID =  50565875333-- 34709682650
ORDER BY Businessday DESC

--110 -- 50824182806, 41 -- 50797201315


--select * from LS_PRODDRGSDB01.ccgs_coreissue.dbo.errortnpjobs_processed_log with (nolock) where acctid= 13165413

SELECT * 
FROM CurrentBalanceAuditPS WITH (NOLOCK)
WHERE AID IN (SELECT acctId FROM CPSgmentAccounts WITH (NOLOCK) WHERE Parent02AID = 17188703)
AND DENAME IN (210, 200, 115)
--AND Businessday >= '2022-01-31 23:59:57.000'
--AND AID = 10179050
--AND TID = 50446653276
ORDER BY Businessday DESC





5291352276


SELECT * 
FROM CurrentBalanceAuditPS WITH (NOLOCK)
WHERE AID = 16354533
--AND DENAME IN (111)
AND Businessday >= '2022-06-30 23:59:57'
--AND AID = 10179050
--AND TID = 49548537392
--AND IdentityField = 5353086943
ORDER BY Businessday DESC


SELECT CBA.*, CP.CMTTranType, CP.TransactionAmount 
FROM CurrentBalanceAuditPS CBA WITH (NOLOCK)
JOIN CCard_Primary CP WITH (NOLOCK) ON (CBA.TID = CP.TranID)
WHERE AID = 70737324
AND DENAME IN (111)
--AND Businessday <= '2021-11-06 17:00:18.000'
--AND AID = 10179050
--AND TID = 49548537392
--AND IdentityField = 5353086943
ORDER BY Businessday DESC


SELECT * 
FROM CurrentBalanceAuditPS WITH (NOLOCK)
WHERE IdentityField = 5334744612

SELECT * 
FROM CurrentBalanceAuditPS WITH (NOLOCK)
WHERE AID IN (SELECT acctId FROM CPSgmentAccounts WITH (NOLOCK) WHERE Parent02AID = 2998354)
AND DENAME IN (111)
AND Businessday <= '2021-11-06 17:00:18.000'
AND AID = 69541821
--AND TID = 49548537392
ORDER BY Businessday DESC


SELECT * 
FROM CurrentBalanceAuditPS WITH (NOLOCK)
WHERE AID IN (SELECT acctId FROM CPSgmentAccounts WITH (NOLOCK) WHERE Parent02AID = 2080512)
AND DENAME IN (111)
--AND Businessday <= '2021-11-06 17:00:18.000'
AND AID = 3486504
AND TID = 50824182806
ORDER BY Businessday DESC


SELECT * 
FROM CurrentBalanceAuditPS WITH (NOLOCK)
WHERE AID IN (SELECT acctId FROM CPSgmentAccounts WITH (NOLOCK) WHERE Parent02AID = 2080512)
AND DENAME IN (111)
--AND Businessday <= '2021-11-06 17:00:18.000'
--AND AID = 3486504
AND TID = 50824182806
ORDER BY Businessday DESC

--69541821




SELECT * FROM CCArd_Primary WITH (NOLOCK) WHERE TranID = 60014820424



/*
SELECT * 
FROM CurrentBalanceAudit WITH (NOLOCK)
WHERE AID IN 
(12415, 13524, 14117, 47850, 52711, 115716, 122810, 244248, 417786, 588281, 659234, 883659, 1240951, 
1255358, 1344799, 1356278, 1378174, 1392139, 1508643, 1722050, 1841625, 1845697, 2105008, 2706267, 2724147, 2837196, 2983913,
3996361, 7853217, 8940606, 9806096, 10655987, 11089488, 11520974, 13572797, 13611044, 18041996, 18390195, 13071394, 20602937,
14886219, 16564141, 18074751, 18310493, 18533310, 21398959)
--AND DENAME IN (112)
AND Businessday = '2021-10-31 23:59:57.000'
--AND TID =  38713367776-- 34709682650
ORDER BY Businessday DESC


SELECT * 
FROM CurrentBalanceAudit WITH (NOLOCK)
WHERE AID IN 
(SELECT acctId FROM PastDueAgingReportData WITH (NOLOCK)
WHERE ReportDate = '2021-11-02 23:59:57.000'
AND CurrentDue + PastDueBalance > AmountOfTotalDue)
AND DENAME IN (112)
AND Businessday >= '2021-10-31 23:59:57.000'
--AND TID =  38713367776-- 34709682650
--ORDER BY Businessday DESC



SELECT CB.*, SH.Systemstatus, 
'UPDATE TOP(1) CurrentBalanceAudit SET NewValue = ''2'' WHERE AID = ' + TRY_CAST(CB.AID AS VARCHAR) + ' AND ATID = 51 AND IdentitiField = ' + TRY_CAST(CB.IdentityField AS VARCHAR)
--'DELETE TOP(1) FROM CurrentBalanceAudit WHERE AID = ' + TRY_CAST(CB.AID AS VARCHAR) + ' AND ATID = 51 AND IdentitiField = ' + TRY_CAST(CB.IdentityField AS VARCHAR)
FROM CurrentBalanceAudit CB WITH (NOLOCK)
JOIN LS_PRODDRGSDB01.ccgs_coreissue_secondary.dbo.StatementHeader SH WITH (NOLOCK) ON (CB.AID = SH.acctId AND CB.Businessday = SH.StatementDAte)
WHERE AID IN 
(122810,244248,417786,588281,659234,883659,1255358,1240951,1344799,1356278,1378174,1508643,1722050,1841625,1845697,2706267,2724147,2837196,3996361
,7853217,8940606,9806096,10655987,11089488,11520974,13071394,13572797,13611044,14886219,16564141,18041996,18310493,18390195,18533310,19628952,20602937
,21091933,21365712,21398959)
AND DENAME IN (112)
AND CB.Businessday = '2021-10-31 23:59:57.000'
AND SH.SystemStatus = 2 AND CB.NewValue = '15991'
--AND SH.SystemStatus = 2 AND CB.NewValue = '3'
--AND SH.SystemStatus  = TRY_CAST(CB.NewValue  AS int)
--AND TID =  38713367776-- 34709682650
--ORDER BY Businessday DESC


SELECT CB.*, SH.CycleDueDTD,
--'UPDATE TOP(1) CurrentBalanceAudit SET NewValue = ''0'' WHERE AID = ' + TRY_CAST(CB.AID AS VARCHAR) + ' AND ATID = 51 AND IdentitiField = ' + TRY_CAST(CB.IdentityField AS VARCHAR)
'DELETE TOP(1) FROM CurrentBalanceAudit WHERE AID = ' + TRY_CAST(CB.AID AS VARCHAR) + ' AND ATID = 51 AND IdentitiField = ' + TRY_CAST(CB.IdentityField AS VARCHAR)
FROM CurrentBalanceAudit CB WITH (NOLOCK)
JOIN LS_PRODDRGSDB01.ccgs_coreissue_secondary.dbo.StatementHeader SH WITH (NOLOCK) ON (CB.AID = SH.acctId AND CB.Businessday = SH.StatementDAte)
WHERE AID IN 
(122810,244248,417786,588281,659234,883659,1255358,1240951,1344799,1356278,1378174,1508643,1722050,1841625,1845697,2706267,2724147,2837196,3996361
,7853217,8940606,9806096,10655987,11089488,11520974,13071394,13572797,13611044,14886219,16564141,18041996,18310493,18390195,18533310,19628952,20602937
,21091933,21365712,21398959)
AND DENAME IN (115)
AND CB.Businessday = '2021-10-31 23:59:57.000'
--AND SH.CycleDueDTD = 0 AND CB.NewValue = '2'
AND SH.CycleDueDTD = 1 AND CB.NewValue = '2'
--AND SH.SystemStatus  = TRY_CAST(CB.NewValue  AS int)
--AND TID =  38713367776-- 34709682650
--ORDER BY Businessday DESC




SELECT CB.*, SH.AmountOfTotalDue,
'UPDATE TOP(1) CurrentBalanceAudit SET NewValue = ''' + TRY_CAST(SH.AmountOfTotalDue AS VARCHAR) +''' WHERE AID = ' + TRY_CAST(CB.AID AS VARCHAR) + ' AND ATID = 51 AND IdentitiField = ' + TRY_CAST(CB.IdentityField AS VARCHAR)
--'DELETE TOP(1) FROM CurrentBalanceAudit WHERE AID = ' + TRY_CAST(CB.AID AS VARCHAR) + ' AND ATID = 51 AND IdentitiField = ' + TRY_CAST(CB.IdentityField AS VARCHAR)
FROM CurrentBalanceAudit CB WITH (NOLOCK)
JOIN LS_PRODDRGSDB01.ccgs_coreissue_secondary.dbo.StatementHeader SH WITH (NOLOCK) ON (CB.AID = SH.acctId AND CB.Businessday = SH.StatementDAte)
WHERE AID IN 
(122810,244248,417786,588281,659234,883659,1255358,1240951,1344799,1356278,1378174,1508643,1722050,1841625,1845697,2706267,2724147,2837196,3996361
,7853217,8940606,9806096,10655987,11089488,11520974,13071394,13572797,13611044,14886219,16564141,18041996,18310493,18390195,18533310,19628952,20602937
,21091933,21365712,21398959)
AND DENAME IN (200)
AND CB.Businessday = '2021-10-31 23:59:57.000'


--SELECT TOP 100 'Statement====>', acctId, SystemStatus, CycleDueDTD, SH.StatementID, StatementDate, Principal, MinimumPaymentDue, AmtOfPayPastDue, AmountOFPaymentsCTD, IntBilledNotPaid, SBWithInstallmentDue, SRBWithInstallmentDue, SH.AmountOfTotalDue,amtofpaycurrdue,AmtOfPayXDLate,AmountOfPayment30DLate, AmountOfPayment60DLate, 
--AmountOfPayment90DLate, AmountOfPayment120DLate, AmountOfPayment150DLate, AmountOfPayment180DLate,AmountOfPayment210DLate,
--(amtofpaycurrdue+AmtOfPayXDLate+AmountOfPayment30DLate+ AmountOfPayment60DLate+ AmountOfPayment90DLate+ AmountOfPayment120DLate+ AmountOfPayment150DLate+ AmountOfPayment180DLate+ AmountOfPayment210DLate) AS CalculatedAD,
--SH.CycleDueDTD, DateOfOriginalPaymentDUeDTD, SystemStatus, CCInhParent125AID, BeginningBalance, CurrentBalance, CurrentBalanceCO, ManualInitialChargeOffReason, AutoInitialChargeOffReason, WaiveMinDue
--FROM LS_PRODDRGSDB01.ccgs_coreissue_secondary.dbo.StatementHeader SH WITH (NOLOCK)
--WHERE SH.acctID IN
--(12415, 13524, 14117, 47850, 52711, 115716, 122810, 244248, 417786, 588281, 659234, 883659, 1240951, 
--1255358, 1344799, 1356278, 1378174, 1392139, 1508643, 1722050, 1841625, 1845697, 2105008, 2706267, 2724147, 2837196, 2983913,
--3996361, 7853217, 8940606, 9806096, 10655987, 11089488, 11520974, 13572797, 13611044, 18041996, 18390195, 13071394, 20602937, 
--14886219, 16564141, 18074751, 18310493, 18533310)
--AND SystemStatus = 2
--AND StatementDate = '2021-10-31 23:59:57.000'
--ORDER BY StatementDate DESC


*/