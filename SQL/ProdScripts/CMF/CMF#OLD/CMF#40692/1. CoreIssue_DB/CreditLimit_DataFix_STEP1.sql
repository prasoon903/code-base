USE CCGS_CoreIssue
GO

DROP TABLE IF EXISTS TEMP_CreditLimit
GO

CREATE TABLE TEMP_CreditLimit
(
	Skey DECIMAL(19,0) IDENTITY(1,1) NOT NULL,
	acctId INT,
	AccountNumber VARCHAR(19),
	AccountUUID VARCHAR(64),
	CreditLimit MONEY,
	SystemStatus INT,
	JobStatus INT 
)

DROP INDEX IF EXISTS IX_TEMP_CreditLimit_Skey ON TEMP_CreditLimit
CREATE CLUSTERED INDEX IX_TEMP_CreditLimit_Skey  
    ON dbo.TEMP_CreditLimit (Skey);   
GO  

DROP INDEX IF EXISTS IDX_TEMP_CreditLimit_JobStatus ON TEMP_CreditLimit

CREATE NONCLUSTERED INDEX IDX_TEMP_CreditLimit_JobStatus ON TEMP_CreditLimit
(
	JobStatus
)

INSERT INTO TEMP_CreditLimit (acctId, AccountNumber, AccountUUID, CreditLimit, SystemStatus, JobStatus)
SELECT BP.acctId, BP.AccountNumber, BP.UniversalUniqueID, BP.TempCreditLimit, BP.SystemStatus, 0
FROM BSegment_Primary BP WITH (NOLOCK)
WHERE BP.acctId IN
(
282933
, 288344
, 289496
, 343689
, 504323
, 550897
, 1052075
, 1079906
, 1084432
, 1108378
, 1109900
, 1140693
, 1142576
, 1143381
, 1144337
, 1144489
, 1145425
, 1153683
, 1153717
, 1155947
, 1156412
, 1182041
, 1182129
, 1187227
, 1194488
, 1195169
, 1299978
, 1710182
, 1748953
, 1977764
, 20681
, 61349
, 63488
, 119373
, 168339
, 183642
, 198178
, 201830
, 273942
, 274780
, 277560
, 277682
, 282034
, 302632
, 302946
, 305515
, 306855
, 309122
, 311700
, 313200
, 335323
, 336189
, 339546
, 340905
, 341456
, 342243
, 2038104
, 2090550
, 2122026
, 2136438
, 2379213
, 2565273
, 343021
, 345523
, 347967
, 348136
, 407331
, 415989
, 429921
, 445529
, 498208
, 504695
, 538652
, 540389
, 542178
, 551362
, 584480
, 589246
, 1046114
, 1047264
, 1050543
, 1050722
, 1050938
, 1052291
, 1053009
, 1053461
, 1053921
, 1054293
, 1054614
, 1079740
, 1079762
, 1080277
, 1080360
, 1080617
, 1080775
, 1080887
, 1080908
, 1081049
, 1081843
, 1081906
, 1082076
, 1082161
, 1082468
, 1082914
, 1083877
, 1084855
, 1085225
, 1085381
, 1108358
, 1108548
, 1110294
, 1110656
, 1111318
, 1111519
, 1111630
, 1111892
, 1112169
, 1112333
, 1112621
, 1112727
, 1112735
, 1138185
, 1138416
, 1138419
, 1138610
, 1139518
, 1139577
, 1140215
, 1140428
, 1140666
, 1140714
, 1141898
, 1141947
, 1141998
, 1142654
, 1144078
, 1144123
, 1145956
, 1146084
, 1146583
, 1146633
, 1146770
, 1147030
, 1147158
, 1147226
, 1148239
, 1148252
, 1148950
, 1149034
, 1149086
, 1149481
, 1149993
, 1150316
, 1151107
, 1151245
, 1151248
, 1152018
, 1152105
, 1153105
, 1153292
, 1153640
, 1154386
, 1154789
, 1155079
, 1155111
, 1156044
, 1156614
, 1181847
, 1182331
, 1183048
, 1183202
, 1183253
, 1183414
, 1183607
, 1183804
, 1185561
, 1185772
, 1185931
, 1185973
, 1186731
, 1187465
, 1187646
, 1188496
, 1189420
, 1190174
, 1190443
, 1190493
, 1192318
, 1192334
, 1192719
, 1193155
, 1193638
, 1194292
, 1194788
, 1196138
, 1197292
, 1324350
, 1341197
, 1674718
, 1691054
, 1693487
, 1708640
, 1713673
, 1741634
, 1744766
, 1757503
, 1762814
, 1783587
, 1832136
, 1836452
, 1841954
, 1843287
, 1870664
, 1878074
, 1883488
, 1885035
, 1891219
, 1898039
, 1900508
, 1902930
, 1904036
, 1905003
, 1925649
, 1934466
, 1965271
, 1968297
, 1972925
, 1998171
, 2004817
, 2012617
, 2017951
, 2020535
, 2023490
, 2023866
, 2028385
, 2035693
, 2058724
, 2059497
, 2068600
, 2082117
, 2082511
, 2142965
, 2162092
, 2186160
, 2191556
, 2207288
, 2214415
, 2216753
, 2218262
, 2231104
, 2240461
, 2259866
, 2274764
, 2305443
, 2315826
, 2322238
, 2336412
, 2348891
, 2358213
, 2371980
, 2378128
, 2382298
, 2390343
, 2396370
, 2398699
, 2400589
, 2401610
, 2430968
, 2480925
, 2482540
, 2490927
, 2529100
, 2588962
, 2634139
, 2635153
, 2638170
, 2656374
, 2666724
, 2669533
, 1183628
)
